var PhotoSwipeAddon=function(t){"use strict";var o=this,l="";o.options={el:"",thumbnails:!0,wrap:"pswp-addon",item:"a",items:[],animateZoom:!0,pswp_settings:{}},null!==t&&$.extend(o.options,t),o.init=function(){o.pswpElement=document.querySelectorAll(".pswp")[0],o.getItems(),o.makePswpSettings(),o.makeThumbs(),o.openPSWP(),o.bindThumbsEvents(),o.setActiveThumb(),o.video()},o.getItems=function(){0===o.options.items.length&&o.options.el.closest(o.options.wrap).find(o.options.item).each(function(t,e){var i=$(this),s={src:i.attr("href"),msrc:i.find("img").attr("src"),w:i.attr("data-w"),h:i.attr("data-h"),title:i.attr("title"),pid:t,el:i};if(i.attr("data-url")&&o.isValidYouTubeUrl(i.attr("data-url"))){var a="";a+='<div class="video-wrap">',a+="<div>",a+='<iframe src="" frameborder="0" allowfullscreen></iframe>',a+="</div>",a+="</div>",a+='<div class="image-wrap" data-url="'+i.attr("data-url")+'">',a+='<img src="'+i.attr("href")+'" class="pswp_img">',a+="</div>",s={msrc:i.find("img").attr("src"),w:i.attr("data-w"),h:i.attr("data-h"),title:i.attr("title"),pid:t,el:i,html:a}}if(o.options.items.push(s),!0===o.options.thumbnails){var n="<li>"+i.html()+"</li>";i.attr("data-url")&&o.isValidYouTubeUrl(i.attr("data-url"))&&(n='<li class="video-thumb">'+i.html()+"</li>"),l+=n}})},o.makeThumbs=function(){!0===o.options.thumbnails&&0<l.length&&($(".pswp").addClass("pswp__has-thumbs"),$(".pswp__thumbs-list").html("").append("<ul>"+l+"</ul>"))},o.bindThumbsEvents=function(){$(".pswp");0<l.length&&($(document).off("click.pswp__thumbs").on("click.pswp__thumbs",".pswp__thumbs li",function(){var t=$(this);o.pswpGallery.goTo(t.index()),t.addClass("pswp__thumb-active").siblings().removeClass("pswp__thumb-active"),t.hasClass("video-thumb")&&$(".image-wrap").trigger("click")}),o.pswpGallery.listen("afterChange",function(){o.setActiveThumb()}),o.pswpGallery.listen("close",function(){$(".pswp").removeClass("pswp__has-thumbs")}))},o.setActiveThumb=function(){if(0<l.length){var t=$(".pswp__thumbs li").eq(o.pswpGallery.getCurrentIndex()),e=0;e=0===t.prev().length?t.offset().left+$(".pswp__thumbs").scrollLeft():t.prev().offset().left+$(".pswp__thumbs").scrollLeft(),$(".pswp__thumbs").stop(!1,!1).animate({scrollLeft:e},300,"swing"),t.addClass("pswp__thumb-active").siblings().removeClass("pswp__thumb-active")}},o.makePswpSettings=function(){o.options.animateZoom&&(o.pswp_settings_addon={getThumbBoundsFn:function(t){var e=o.options.items[t].el[0].getElementsByTagName("img")[0],i=window.pageYOffset||document.documentElement.scrollTop,s=e.getBoundingClientRect();return{x:s.left,y:s.top+i,w:s.width}}}),$.extend(o.options.pswp_settings,o.pswp_settings_addon)},o.openPSWP=function(){o.pswpGallery=new PhotoSwipe(o.pswpElement,PhotoSwipeUI_Default,o.options.items,o.options.pswp_settings),o.pswpGallery.init()},o.isValidYouTubeUrl=function(t){return!!t.match(/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/)&&RegExp.$1},o.video=function(){o.playVideoAfterClicked=!0,o.options.el.attr("data-url")&&o.isValidYouTubeUrl(o.options.el.attr("data-url"))&&o.playVideoAfterClicked&&(o.videoReplace($(".image-wrap").filter('[data-url="'+o.options.el.attr("data-url")+'"]')),o.playVideoAfterClicked=!1),$("body").on("touchstart click",".image-wrap",function(){o.videoReplace($(this))}),o.pswpGallery.listen("beforeChange",function(){var t=$(".image-wrap"),e=t.siblings(".video-wrap").find("iframe");o.pauseVideo(),t.show(),e.attr("src","").hide()}),o.pswpGallery.listen("close",function(){$(".image-wrap").siblings(".video-wrap").find("iframe");o.pauseVideo()})},o.videoReplace=function(t){var e=t.attr("data-url"),i="https://www.youtube.com/embed/"+o.isValidYouTubeUrl(e)+"?wmode=opaque&amp;autoplay=1&amp;enablejsapi=1";t.hide(),t.siblings(".video-wrap").find("iframe").show().attr("src",i),t.siblings(".video-wrap").show()},o.pauseVideo=function(){var t=$(".image-wrap").siblings(".video-wrap").find("iframe");0<t.length&&t.filter('[src*="://"]').each(function(t,e){e.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")})},o.init()};